<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Apply arbitrary expressions to fields within [S4class][humdrumRclass] data."><title>with(in)Humdrum — withinHumdrum • humdrumR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="with(in)Humdrum — withinHumdrum"><meta property="og:description" content="Apply arbitrary expressions to fields within [S4class][humdrumRclass] data."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">humdrumR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/GettingStarted.html">Getting started with humdrumR</a>
    <a class="dropdown-item" href="../articles/HumdrumSyntax.html">The Humdrum Syntax</a>
    <a class="dropdown-item" href="../articles/Intervals.html">Rhythm and Pitch Intervals</a>
    <a class="dropdown-item" href="../articles/IntroForCoders.html">HumdrumR for Coders</a>
    <a class="dropdown-item" href="../articles/KeysAndChord.html">Diatonic and Tertian Sets in humdrumR</a>
    <a class="dropdown-item" href="../articles/Overview.html">Overview of humdrumR</a>
    <a class="dropdown-item" href="../articles/ReadWrite.html">Reading and writing data with humdrumR</a>
    <a class="dropdown-item" href="../articles/RhythmAndMeter.html">Rhythm and Meter in humdrumR</a>
    <a class="dropdown-item" href="../articles/Validation.html">Validating Humdrum Data</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="nav-link" href="https://github.com/Computational-Cognitive-Musicology-Lab/humdrumR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>with(in)Humdrum</h1>
      <small class="dont-index">Source: <a href="https://github.com/Computational-Cognitive-Musicology-Lab/humdrumR/blob/HEAD/R/Apply.R"><code>R/Apply.R</code></a></small>
      <div class="d-none name"><code>withinHumdrum.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Apply arbitrary expressions to fields within <code>[S4class][humdrumRclass]</code> data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">withinHumdrum</span><span class="op">(</span><span class="va">humdrumR</span>, <span class="va">...</span><span class="op">)</span>

<span class="fu">withHumdrum</span><span class="op">(</span><span class="va">humdrumR</span>, <span class="va">...</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu">inHumdrum</span><span class="op">(</span><span class="va">humdrumR</span>, <span class="va">...</span><span class="op">)</span>

<span class="fu">humApply</span><span class="op">(</span><span class="va">humdrumR</span>, <span class="va">FUN</span>, <span class="va">...</span>, within <span class="op">=</span> <span class="cn">TRUE</span>, doplot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>humdrumR</dt>
<dd><p>A <a href="humdrumRclass.html">humdrumRclass</a> data object.</p></dd>
<dt>...</dt>
<dd><p>Any arguments which can be fed to
<code>[humdrumR:with-in-Humdrum][with(in)Humdrum]</code> as formulae (except for
<code>do</code> expressions, which are replaced by the <code>FUN</code> argument!).
However, rather that writinging formula in the format <code>Keyword ~ Expression</code>,
<code>humApply</code> arguments should be written as normal <code>R</code> arguments:
<code>Keyword = Expression</code>.
Unnamed arguments are ignored.
#' @param within A logical. If <code>TRUE</code> (the default),
<code>[humdrumR:with-in-Humdrum][withinHumdrum]</code> is used to apply the
function---meaning that the output is reconstituted into a new field in the
<code>humdrumR</code> object. If <code>within == FALSE</code>,
<code>[humdrumR:with-in-Humdrum][withHumdrum]</code> is used instead,
which results in the function's output being returned inprocessed.</p></dd>
<dt>drop</dt>
<dd><p>This argument is concetually similar to the <code>drop</code> argument in R matrices and data.frames.
If <code>drop = TRUE</code>, the output of <code>withHumdrum</code> is simplified as much as possible (trying to return
the "raw" vector, list, table, etc. within it). If <code>drop = FALSE</code>, the result is <em>always</em>
a <code>data.table</code>. The default value (<code>drop = TRUE</code>) is usually what we want because it is more
intuitive, but in more complex code, it can be helpful to set <code>drop = FALSE</code> so that
the output is consistent.</p></dd>
<dt>FUN</dt>
<dd><p>A function to apply to the humdrumR:humdrumR<code>field(s) in the</code>humdrumR` object.</p></dd>
<dt>doplot</dt>
<dd><p>Boolean. If <code>TRUE</code> the <code>FUN</code> argument is treated
as a <code>doplot</code> expression by <code>[humdrumR:with-in-Humdrum][with(in)Humdrum]</code>,
so the result is ignored (for plotting or side-effects purposes).</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>From <code>withinHumdrum</code> and <code>inHumdrum</code>, a new humdrumR data object.
From <code>withHumdrum</code>, whatever value is returned by expression.</p>
    </div>
    <div class="section level2">
    <h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a></h2>
    

<p>These functions are the primary means of working with
humdrumR data. (They are analogous to the base functions
<code>[base][with]</code> and <code>[base][within]</code>
as applied to <code>[base:data.frame][data.frames]</code>.)
Specifically they allow you to evaluate arbitrary
expressions involving fields in a humdrumR data object.
They also includes a number of special evaluation options:</p><ul><li><p>Evaluate an expression in only matching parts of the data.</p></li>
<li><p>Evaluate an expression separately in subsets of the data.</p></li>
<li><p>Evaluate an expression across windows in the data (e.g., ngrams, rolling windows).</p></li>
<li><p>Evaluate an expression which produces a plot, with particular plotting parameters set using <code>[graphics][par]</code>.</p></li>
</ul><p>The difference between <code>withHumdrum</code> and <code>withinHumdrum</code> is
analogous to the difference between <code>[base][with]</code> and <code>[base][within]</code>.
<code>withHumdrum</code> evaluates your expression(s) and then simply returns the result of
the evaluation. <code>withinHumdrum</code> evaluates your expression(s) and then
(attempts) to insert the results back into the humdrumR object, generating new
fields called <code>PipeX</code> (see details).</p>
<p><code>inHumdrum</code> is simply a short hand for <code>withinHumdrum</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="formulae"><code>Formulae</code><a class="anchor" aria-label="anchor" href="#formulae"></a></h2>
    

<p>Every formula in the <code>formulae</code> argument
is treated as a <code>Keyword ~ Expression(s)</code>
pairing. Multiple expressions can be input using multiple <code>~</code> operators:
<code>Keyword ~ Expression1 [~ Expression2 ~ ... ~ ExpressionN]</code>
(the leftmost expression is treated as the keyword.)
If there is no leftmost expression (i.e., <code>~ Expression</code>), the Keyword
defaults to "<code>do</code>." The keyword expression must be a single, simple name/symbol, following
standard R rules (i.e., "<code>.foobar</code>" is acceptable but "<code>3 + foobar</code>" is not).</p>
<p>Legal keywords, and their meanings are:</p><ol><li><p><code>do</code> An expression to be evaluated within the <code>humdrumR</code> data object (see "Expression evaluation").</p></li>
<li><p><code>doplot</code> An expression to be evaluated within the <code>humdrumR</code> data object while ignoring the result of the expression (see "Expression evaluation" and "Plotting".</p></li>
<li><p><code>by</code> An expression used to break the data into groups, with the <code>do</code> expression(s) evaluated
separately in each group (see "Partitioning").</p></li>
<li><p><code>where</code> An expression indicating a subset of the data in which to evaluate the <code>do</code> expression (see "Partitioning").</p></li>
<li><p><code>ngrams</code> A positive number <em>n</em>. The expression is evaluated across overlapping length-<em>n</em> windows.</p></li>
<li><p><code>recordtypes</code> A string or vector of characters drawn from <code>c("D", "d", "I", "L", "M","G")</code>. These characters
correspond to types of humdrum records: <strong>D</strong>ata, null <strong>d</strong>ata, <strong>I</strong>nterpretations,
<strong>M</strong>easures, <strong>L</strong>ocal comments, and <strong>G</strong>lobal comments respectively. The expression
is only evaluated on data drawn from the specified record types (defaults to <code>"D"</code>).</p></li>
<li><p><code>pre</code> An expression to evaluate once before evaluating the do expression(s). Useful, for instance, for taking logs
or opening a graphing window. The <code>pre</code> expression is evaluated in the global environment.</p></li>
<li><p><code>post</code> An expression evaluate once after evaluating the do expression(s). Always evaluated in the global environment.</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="expression-evaluation">Expression evaluation<a class="anchor" aria-label="anchor" href="#expression-evaluation"></a></h2>
    


<p>The right-hand side of any formula in the <code>formulae</code> argument with the keyword <code>do</code> or <code>doplot</code>
(or with no keyword specified) is evaluated within the <code>humdrumR</code> data object.
The expression can, thus, refer to any field in the humdrumR object (Record, Token, File, etc.).
You can also include a <code>.</code> anywhere in the expression, which will be
interpreted as the humdrumR object's current <code>[dest=humdrumR][Active]</code>
expression.</p><div class="sourceCode"><pre><code><span class="va">humdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readHumdrum.html">readHumdrum</a></span><span class="op">(</span><span class="st">'directorywithdata/*.krn'</span><span class="op">)</span> <span class="co"># read some data</span>

<span class="fu"><a href="../reference/withinHumdrum.html">withinHumdrum</a></span><span class="op">(</span><span class="va">humdata</span>, <span class="op">~</span><span class="fu">getPitch</span><span class="op">(</span><span class="va">Token</span><span class="op">)</span><span class="op">)</span> <span class="co"># The most basic pattern</span>
<span class="fu"><a href="../reference/withinHumdrum.html">withinHumdrum</a></span><span class="op">(</span><span class="va">humdata</span>, <span class="op">~</span><span class="fu">getPitch</span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span> <span class="co"># Same as previous (unless `Active` field has been changed))</span>

<span class="fu"><a href="../reference/withinHumdrum.html">withinHumdrum</a></span><span class="op">(</span><span class="va">humdata</span>, <span class="op">~</span><span class="fu"><a href="../reference/pitchFunctions.html">solfa</a></span><span class="op">(</span><span class="fu">getPitch</span><span class="op">(</span><span class="va">Token</span><span class="op">)</span>, key <span class="op">=</span> <span class="va">Key</span><span class="op">)</span><span class="op">)</span> 
<span class="co"># Assumes that the Key field was parsed during the call to `[readHumdrum][readHumdrum]`</span>

<span class="fu"><a href="../reference/withinHumdrum.html">withinHumdrum</a></span><span class="op">(</span><span class="va">humdata</span>, <span class="op">~</span><span class="fu">getSemits</span><span class="op">(</span><span class="va">Token</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu">getSemits</span><span class="op">(</span><span class="va">Token</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>

<p>If multiple <code>do</code> expressions are provided, they are each evaluated one at a time,
with the result of each piped into the next. Other, non-<code>do</code>, formulae (like <code>by~</code> or
<code>ngrams~</code>) are reused for each expression evaluated.</p>
    </div>
    <div class="section level2">
    <h2 id="partitioning">Partitioning<a class="anchor" aria-label="anchor" href="#partitioning"></a></h2>
    


<p>A <code>by</code> expression is used to break the data into subsets, with the <code>do</code> expression(s) evaluated
separately within each subset. This works the similarly to the <code>by</code> argument in
<code>[data.table][data.table]</code>s, the <code>INDEX</code>
argument of <code>[base][tapply]</code>, or the <code>INDICES</code> argument of <code>[base][by]</code>.
Each <code>by</code> expression must evaluate, within the <code>humdrumR</code> data object, to a vector (or a list of vectors
of equal length) of categories to group the data by.
Most commonly, the <code>by</code> expression(s) are simply field(s) in the data:
for instance,</p><div class="sourceCode"><pre><code><span class="fu"><a href="../reference/withinHumdrum.html">withinHumdrum</a></span><span class="op">(</span><span class="va">humdata</span>,
         <span class="va">do</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">Token</span><span class="op">)</span>,
         <span class="va">by</span> <span class="op">~</span> <span class="va">File</span><span class="op">)</span></code></pre></div>

<p>will apply the function <code>[base][table]</code> to the <code>Token</code> field
<em>separately</em> for each file in the <code>humdrumR</code> data.
However, we can also use more complex expressions like</p><div class="sourceCode"><pre><code>withinHumdrum(humdata,
         do ~ table(Token), 
         by ~ Spine &gt; 3 | Record \%\% 2 == 0)
</code></pre></div>

<p>which will evaluate the do expression in two groups, one where either the spine number is
three or less <em>or</em> the record number is even, and another group where the opposite is true.</p>
<p>If the <code>by</code> expression evaluates to a list of grouping vectors,
the <code>do</code> expressions are evaulated across every combination of categories in all the vectors.
Thus,
withinHumdrum(humdata,
do ~ table(Token),
by ~ list(File, Spine))
will apply <code>table</code> to <code>Token</code> across each spine <em>in</em> each file.
As some <a href="https://en.wikipedia.org/wiki/Syntactic_sugarsyntactic" class="external-link">syntactic sugar</a>, if the
<code>by</code> expression has more than two parts, all parts except
the (leftmost) keyword part are combined in a list (i.e., <code>by ~ File ~ Spine</code>
becomes <code>by ~ list(File, Spine)}</code>.
Thus the previous example can also be written:
withinHumdrum(humdata,
do ~ table(Token),
by ~ File ~ Spine)</p>
<p>A <code>where</code> expression is used to identify a subset of the data and evaluate
the <code>do</code> expression(s) <em>only</em> in that subset.
<code>where</code> expressions must evaluated, within the <code>humdrumR</code> data object, to
a single logical vector. The <code>do</code> expression(s) are only evaluated where this logical
vector is <code>TRUE</code>.
Wherever the <code>where</code> expression evaluates to <code>FALSE</code>, the original <code>humdrumR</code> data is
kept unchanged.</p>
<p>If multiple partitioning formulae (i.e, <code>by</code> and <code>where</code>) expressions
are evaluated recursively, in order from left to right. Thus if you specify
withinHumdrum(humdata,
do ~ sd(semits),
by ~ File,
where ~ semits &gt; mean(semits))
a the standard deviation of the <code>semits</code> field will be calculated only in each file,
but only where the <code>semits</code> field is greater than the mean <code>semits</code> value
<em>within that file</em>. Contrast this with this call:
withinHumdrum(humdata,
do ~ sd(semits)
where ~ semits &gt; mean(semits),
by ~ File)
wherein the standard deviation of <code>semits</code> is, again, calculated for each file,
but this time wherever the <code>semits</code> field is greater than the mean value <em>across all the data</em>.</p>
    </div>
    <div class="section level2">
    <h2 id="plotting">Plotting<a class="anchor" aria-label="anchor" href="#plotting"></a></h2>
    

<p>The <code>doplot</code> keyword behaves exactly like the <code>do</code> keyword, except that the result of the
evaluation is ignored. This is useful for plotting <em>as well as</em> other side-effects (like writing to a file).
If <code>doplot</code> is used with <code>withHumdrum</code>, the function simply returns <code>NULL</code> (after executing the <code>doplot</code>
expression
If <code>doplot</code> is used with <code>withinHumdrum</code> (or <code>inHumdrum</code>), the function simply returns the unaltered
<code>humdrumR</code> argument.</p>
<p><code>withinHumdrum</code> also allows you to specify plotting options in line, without having to make a separate call
to <code>[graphics][par]</code>. Any <code>[graphics][par]</code> argument can be specified as a <code>Keyword ~ Expression</code> pair
in the <code>formulae</code> argument. For instance, if you call a <code>doplot</code> expression with a <code>by</code> expression
that creates four groups, R will create four plots---but you will only see the last one! Normally, you would need to
call <code>par(mfcol = c(2,2))</code> <em>before</em> calling your plotting function. However, with <code>withinHumdrum</code> you can
soecific <code>mfcol = c(2,2)</code> right in a <code>formulae</code> formula:
withinHumdrum(humdata,
doplot ~ fooplot(.),
by ~ list(Two, byTwo),
mfcol ~ c(2, 2))
The best part is <code>withinHumdrum</code> will reset <code>par</code> to it's previous state after <code>withinHumdrum</code> is done.</p>
    </div>
    <div class="section level2">
    <h2 id="tandem-interpretations">Tandem interpretations<a class="anchor" aria-label="anchor" href="#tandem-interpretations"></a></h2>
    


<p>The function <code>[readHumdrum][readHumdrum]</code> automatically parses
tandem interpretations (that it recognizes) into
their own fields in the resulting <code>[humdrumR][humdrumRclass]</code> data.
For instance, data with a <code>'*clefF4'</code> will show
up as a <code>Clef</code> field. However, users might read humdrum data with their
own custom tandem interpretations that are not built into <code>humdrumR</code>.
<code>humdrumR</code> includes the function <code>[getTandem][getTandem]</code> to help us
extract arbitrary tandem intrpretation data.
Luckily, <code>withinHumdrum</code> knows some
<a href="https://en.wikipedia.org/wiki/Syntactic_sugarsyntactic" class="external-link">syntactic sugar</a>
which makes it easy to do this anywhere in our expressions, simply by putting a
named object beginning with the symbol <code>*</code>. Of course, R doesn't normally
allow names to begin with symbols like <code>*</code>, but you can force it by
placing grave symbols around the name <code>*name</code>. If you do this in a <code>withinHumdrum</code>
expression, <code>withinHumdrum</code> will treat this name as a
regular expression and substitute a call <code>getTandem(Tandem, 'regular expression')</code> in the expression.
This means you can could do something like
withinHumdrum(humdata,
do ~ myFunction(Token, <code>*mytandempattern</code>))
and <code>myFunction</code> will be called with the first argument being the
<code>Token</code> field, and the second argument being tandem interpretations
which match <code>'mytandempattern'</code> (extracted from the <code>Tandem</code> field).</p>
    </div>
    <div class="section level2">
    <h2 id="splatting">Splatting<a class="anchor" aria-label="anchor" href="#splatting"></a></h2>
    


<p>("Splatting" refers to feeding a function a list/vector of arguments.)
Sometimes we want to divide our data into pieces (a l\'a <code>partition</code> option), but
rather than applying the same expression to each piece, we want to feed
the separate pieces as separate arguments to the same function.
In <code>withinHumdrum</code> you can use some
<a href="https://en.wikipedia.org/wiki/Syntactic_sugarsyntactic" class="external-link">syntactic sugar</a>
to do just this, using the <code>@</code> symbol in the format <code>myFunction(TargetExpr@GroupingExpr)</code>.
If we make this call</p>
<p>withinHumdrum(humdata,
do ~ myFunction(Token@Spine))</p>
<p>and there are four spines
this is how <code>withinHumdrum</code> will intepret the expression:</p>
<p>withinHumdrum(humData,
do ~ myFunction(TokenSpine == 1, # first argument when Spine == 1
TokenSpine == 2, # second argument when Spine == 2
TokenSpine == 3, # etc.
TokenSpine == 4))</p>
    </div>
    <div class="section level2">
    <h2 id="argument-interpolation">Argument interpolation<a class="anchor" aria-label="anchor" href="#argument-interpolation"></a></h2>
    


<p>Any named arguments to <code>withinHumdrum</code> are <code>[humdrumR:interpolateArguments][interpolated]</code> into the
<code>do</code> expressions. This is useful if you've already created a list of formulas that you like, but would like
to make small changes to a function call within the <code>do</code> expressions, without starting from scratch.
Examples:</p><div class="sourceCode"><pre><code><span class="va">mycommand</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">do</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">.</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="va">by</span> <span class="op">~</span> <span class="va">Spine</span> <span class="op">~</span> <span class="va">File</span><span class="op">)</span>
<span class="fu"><a href="../reference/withinHumdrum.html">withinHumdrum</a></span><span class="op">(</span><span class="va">humdata</span>,
              <span class="va">mycommand</span>,
              na.rm <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co"># mycommand is executed with na.rm changed to FALSE              </span></code></pre></div>

    </div>
    <div class="section level2">
    <h2 id="piping">Piping<a class="anchor" aria-label="anchor" href="#piping"></a></h2>
    


<p>For calls to <code>withinHumdrum</code>, the result of each <code>do</code> expression
is insterted back into the <code>[humtable][humdrum table]</code>. The results
are put into new field(s) labeled Pipe1, PipeX, ..., PipeN. If the results
of the expression are shorter than the rows in the humtable,
or an <code>object</code>, the humdrum table is shrunk to fit them.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="va">humdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="readHumdrum.html">readHumdrum</a></span><span class="op">(</span><span class="st">'directorywithdata/*.krn'</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Finding and reading files...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	REpath-pattern 'directorywithdata/*.krn' matches 0 text files in 0 directories.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Zero files read from disk. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No files to validate.</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">withinHumdrum</span><span class="op">(</span><span class="va">humdata</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span> <span class="co"># counts characters in each data token.</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> humdrumR error in:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	tryCatch(withCallingHandlers({</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   saveRDS(do.call(do.call, c(readRDS(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     "/home/nat/.tmp/RtmpqwGfV0/callr-fun-15ea7056d2377"), list(envir = .GlobalEnv,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     quote = TRUE)), envir = .GlobalEnv, quote = TRUE), file = "/home/nat/.tmp/RtmpqwGfV0/callr-res-15ea701f9a8237")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   flush(stdout())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   flush(stderr())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   invisible()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }, error = function(e) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     callr_data &lt;- as.environment("tools:callr")$`__callr_data__`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     err &lt;- callr_data$err</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     assign(".Traceback", .traceback(4), envir = callr_data)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     dump.frames("__callr_dump__")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     assign(".Last.dump", .GlobalEnv$`__callr_dump__`, envir = callr_data)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     rm("__callr_dump__", envir = .GlobalEnv)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e$call &lt;- deparse(conditionCall(e), nlines = 6)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2 &lt;- err$new_error(conditionMessage(e), call. = conditionCall(e))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     class(e2) &lt;- c("callr_remote_error", class(e2))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2$error &lt;- e</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     calls &lt;- sys.calls()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     dcframe &lt;- which(vapply(calls, function(x) length(x) &gt;= 1 &amp;&amp; identical(x[[</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       1]], quote(do.call)), logical(1)))[1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is.na(dcframe)) e2$`_ignore` &lt;- list(c(1, dcframe + 1L))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2$`_pid` &lt;- Sys.getpid()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2$`_timestamp` &lt;- Sys.time()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (inherits(e, "rlib_error_2_0")) e2$parent &lt;- e$parent</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2 &lt;- err$add_trace_back(e2, embed = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     saveRDS(list("error", e2), file = paste0(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       "/home/nat/.tmp/RtmpqwGfV0/callr-res-15ea701f9a8237", ".error"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }, interrupt = function(e) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     callr_data &lt;- as.environment("tools:callr")$`__callr_data__`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     err &lt;- callr_data$err</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     assign(".Traceback", .traceback(4), envir = callr_data)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     dump.frames("__callr_dump__")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     assign(".Last.dump", .GlobalEnv$`__callr_dump__`, envir = callr_data)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     rm("__callr_dump__", envir = .GlobalEnv)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e$call &lt;- deparse(conditionCall(e), nlines = 6)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2 &lt;- err$new_error(conditionMessage(e), call. = conditionCall(e))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     class(e2) &lt;- c("callr_remote_error", class(e2))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2$error &lt;- e</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     calls &lt;- sys.calls()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     dcframe &lt;- which(vapply(calls, function(x) length(x) &gt;= 1 &amp;&amp; identical(x[[</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       1]], quote(do.call)), logical(1)))[1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is.na(dcframe)) e2$`_ignore` &lt;- list(c(1, dcframe + 1L))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2$`_pid` &lt;- Sys.getpid()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2$`_timestamp` &lt;- Sys.time()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (inherits(e, "rlib_error_2_0")) e2$parent &lt;- e$parent</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2 &lt;- err$add_trace_back(e2, embed = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     saveRDS(list("error", e2), file = paste0(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       "/home/nat/.tmp/RtmpqwGfV0/callr-res-15ea701f9a8237", ".error"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }, callr_message = function(e) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   try(signalCondition(e))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }), error = function(e) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   try(stop(e))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }, interrupt = function(e) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   e</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> })</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; tryCatchList(expr, classes, parentenv, handlers)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; tryCatchOne(tryCatchList(expr, names[-nh], parentenv, handlers[-nh]), names[nh],</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> parentenv, handlers[[nh]])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; doTryCatch(return(expr), name, parentenv, handler)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; tryCatchList(expr, names[-nh], parentenv, handlers[-nh])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; tryCatchOne(expr, names, parentenv, handlers[[1L]])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; doTryCatch(return(expr), name, parentenv, handler)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; withCallingHandlers({</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   saveRDS(do.call(do.call, c(readRDS(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     "/home/nat/.tmp/RtmpqwGfV0/callr-fun-15ea7056d2377"), list(envir = .GlobalEnv,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     quote = TRUE)), envir = .GlobalEnv, quote = TRUE), file = "/home/nat/.tmp/RtmpqwGfV0/callr-res-15ea701f9a8237")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   flush(stdout())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   flush(stderr())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   invisible()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }, error = function(e) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     callr_data &lt;- as.environment("tools:callr")$`__callr_data__`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     err &lt;- callr_data$err</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     assign(".Traceback", .traceback(4), envir = callr_data)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     dump.frames("__callr_dump__")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     assign(".Last.dump", .GlobalEnv$`__callr_dump__`, envir = callr_data)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     rm("__callr_dump__", envir = .GlobalEnv)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e$call &lt;- deparse(conditionCall(e), nlines = 6)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2 &lt;- err$new_error(conditionMessage(e), call. = conditionCall(e))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     class(e2) &lt;- c("callr_remote_error", class(e2))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2$error &lt;- e</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     calls &lt;- sys.calls()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     dcframe &lt;- which(vapply(calls, function(x) length(x) &gt;= 1 &amp;&amp; identical(x[[</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       1]], quote(do.call)), logical(1)))[1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is.na(dcframe)) e2$`_ignore` &lt;- list(c(1, dcframe + 1L))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2$`_pid` &lt;- Sys.getpid()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2$`_timestamp` &lt;- Sys.time()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (inherits(e, "rlib_error_2_0")) e2$parent &lt;- e$parent</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2 &lt;- err$add_trace_back(e2, embed = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     saveRDS(list("error", e2), file = paste0(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       "/home/nat/.tmp/RtmpqwGfV0/callr-res-15ea701f9a8237", ".error"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }, interrupt = function(e) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     callr_data &lt;- as.environment("tools:callr")$`__callr_data__`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     err &lt;- callr_data$err</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     assign(".Traceback", .traceback(4), envir = callr_data)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     dump.frames("__callr_dump__")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     assign(".Last.dump", .GlobalEnv$`__callr_dump__`, envir = callr_data)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     rm("__callr_dump__", envir = .GlobalEnv)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e$call &lt;- deparse(conditionCall(e), nlines = 6)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2 &lt;- err$new_error(conditionMessage(e), call. = conditionCall(e))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     class(e2) &lt;- c("callr_remote_error", class(e2))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2$error &lt;- e</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     calls &lt;- sys.calls()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     dcframe &lt;- which(vapply(calls, function(x) length(x) &gt;= 1 &amp;&amp; identical(x[[</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       1]], quote(do.call)), logical(1)))[1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is.na(dcframe)) e2$`_ignore` &lt;- list(c(1, dcframe + 1L))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2$`_pid` &lt;- Sys.getpid()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2$`_timestamp` &lt;- Sys.time()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (inherits(e, "rlib_error_2_0")) e2$parent &lt;- e$parent</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2 &lt;- err$add_trace_back(e2, embed = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     saveRDS(list("error", e2), file = paste0(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       "/home/nat/.tmp/RtmpqwGfV0/callr-res-15ea701f9a8237", ".error"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }, callr_message = function(e) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   try(signalCondition(e))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> })</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; saveRDS(do.call(do.call, c(readRDS(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   "/home/nat/.tmp/RtmpqwGfV0/callr-fun-15ea7056d2377"), list(envir = .GlobalEnv,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   quote = TRUE)), envir = .GlobalEnv, quote = TRUE), file = "/home/nat/.tmp/RtmpqwGfV0/callr-res-15ea701f9a8237")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; do.call(do.call, c(readRDS("/home/nat/.tmp/RtmpqwGfV0/callr-fun-15ea7056d2377"),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> list(envir = .GlobalEnv, quote = TRUE)), envir = .GlobalEnv, quote = TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; &lt;function(what, args, quote = FALSE, envir = parent.frame()) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   if (!is.list(args)) stop("second argument must be a list")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   if (quote) args &lt;- lapply(args, enquote)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .Internal(do.call(what, args, envir))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }&gt;(base::quote(&lt;function(..., crayon_enabled, crayon_colors, pkgdown_internet) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   options(crayon.enabled = crayon_enabled, crayon.colors = crayon_colors,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     pkgdown.internet = pkgdown_internet)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   pkgdown::build_site(...)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }&gt;), base::quote(&lt;list: pkg = &lt;pkgdown&gt;, examples = TRUE, run_dont_run = FALSE,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   seed = 1014, lazy = FALSE, ...&gt;), envir = base::quote(&lt;environment&gt;), quote = base::quote(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   TRUE))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; &lt;function(..., crayon_enabled, crayon_colors, pkgdown_internet) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   options(crayon.enabled = crayon_enabled, crayon.colors = crayon_colors,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     pkgdown.internet = pkgdown_internet)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   pkgdown::build_site(...)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }&gt;(pkg = base::quote(&lt;pkgdown&gt;), examples = base::quote(TRUE), run_dont_run = base::quote(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   FALSE), seed = base::quote(1014), lazy = base::quote(FALSE), override = base::quote(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   &lt;list: &gt;), install = base::quote(FALSE), preview = base::quote(FALSE),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> new_process = base::quote(FALSE), devel = base::quote(FALSE), crayon_enabled = base::quote(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   TRUE), crayon_colors = base::quote(256L), pkgdown_internet = base::quote(TRUE))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; pkgdown::build_site(...)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; build_site_local(pkg = pkg, examples = examples, run_dont_run = run_dont_run,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   seed = seed, lazy = lazy, override = override, preview = preview, devel = devel)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; build_reference(pkg, lazy = lazy, examples = examples, run_dont_run = run_dont_run,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   seed = seed, override = override, preview = FALSE, devel = devel)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; purrr::map(topics, build_reference_topic, pkg = pkg, lazy = lazy, examples_env = examples_env,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   run_dont_run = run_dont_run)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; .f(.x[[i]], ...)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; withCallingHandlers(data_reference_topic(topic, pkg, examples_env = examples_env,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   run_dont_run = run_dont_run), error = function(err) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   msg &lt;- c(paste0("Failed to parse Rd in ", topic$file_in), i = err$message)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   abort(msg, parent = err)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> })</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; data_reference_topic(topic, pkg, examples_env = examples_env, run_dont_run = run_dont_run)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; run_examples(tags$tag_examples[[1]], env = if (is.null(examples_env)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ) NULL else new.env(parent = examples_env), topic = tools::file_path_sans_ext(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   topic$file_in), run_dont_run = run_dont_run)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; highlight_examples(code, topic, env = env)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; downlit::evaluate_and_highlight(code, fig_save = fig_save_topic, env = child_env(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   env), output_handler = evaluate::new_output_handler(value = pkgdown_print))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; evaluate::evaluate(code, child_env(env), new_device = TRUE, output_handler = output_handler)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; evaluate_call(expr, parsed$src[[i]], envir = envir, enclos = enclos, debug = debug,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> last = i == length(out), use_try = stop_on_error != 2L, keep_warning = keep_warning,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> keep_message = keep_message, output_handler = output_handler, include_timing = include_timing)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; timing_fn(handle(ev &lt;- withCallingHandlers(withVisible(eval(expr, envir, enclos)),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> warning = wHandler, error = eHandler, message = mHandler)))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; handle(ev &lt;- withCallingHandlers(withVisible(eval(expr, envir, enclos)),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> warning = wHandler, error = eHandler, message = mHandler))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; try(f, silent = TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; tryCatch(expr, error = function(e) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   call &lt;- conditionCall(e)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   if (!is.null(call)) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (identical(call[[1L]], quote(doTryCatch))) call &lt;- sys.call(-4L)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     dcall &lt;- deparse(call, nlines = 1L)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     prefix &lt;- paste("Error in", dcall, ": ")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     LONG &lt;- 75L</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     sm &lt;- strsplit(conditionMessage(e), "\n")[[1L]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     w &lt;- 14L + nchar(dcall, type = "w") + nchar(sm[1L], type = "w")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (is.na(w)) w &lt;- 14L + nchar(dcall, type = "b") + nchar(sm[1L], type = "b")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (w &gt; LONG) prefix &lt;- paste0(prefix, "\n  ")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   } else prefix &lt;- "Error : "</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   msg &lt;- paste0(prefix, conditionMessage(e), "\n")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .Internal(seterrmessage(msg[1L]))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   if (!silent &amp;&amp; isTRUE(getOption("show.error.messages"))) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     cat(msg, file = outFile)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     .Internal(printDeferredWarnings())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   invisible(structure(msg, class = "try-error", condition = e))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> })</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; tryCatchList(expr, classes, parentenv, handlers)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; tryCatchOne(expr, names, parentenv, handlers[[1L]])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; doTryCatch(return(expr), name, parentenv, handler)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; withCallingHandlers(withVisible(eval(expr, envir, enclos)), warning = wHandler,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> error = eHandler, message = mHandler)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; withVisible(eval(expr, envir, enclos))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; eval(expr, envir, enclos)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; eval(expr, envir, enclos)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; withinHumdrum(humdata, ~ nchar(.))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> In the call withinHumdrum(humdrumR = _), the argument humdrumR must be a humdrumR object.</span>
<span class="r-in"><span class="fu">withinHumdrum</span><span class="op">(</span><span class="va">humdata</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>, <span class="va">by</span> <span class="op">~</span> <span class="va">Spine</span><span class="op">)</span> <span class="co"># Tabulates data tokens in each Spine.</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> humdrumR error in:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	tryCatch(withCallingHandlers({</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   saveRDS(do.call(do.call, c(readRDS(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     "/home/nat/.tmp/RtmpqwGfV0/callr-fun-15ea7056d2377"), list(envir = .GlobalEnv,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     quote = TRUE)), envir = .GlobalEnv, quote = TRUE), file = "/home/nat/.tmp/RtmpqwGfV0/callr-res-15ea701f9a8237")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   flush(stdout())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   flush(stderr())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   invisible()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }, error = function(e) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     callr_data &lt;- as.environment("tools:callr")$`__callr_data__`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     err &lt;- callr_data$err</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     assign(".Traceback", .traceback(4), envir = callr_data)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     dump.frames("__callr_dump__")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     assign(".Last.dump", .GlobalEnv$`__callr_dump__`, envir = callr_data)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     rm("__callr_dump__", envir = .GlobalEnv)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e$call &lt;- deparse(conditionCall(e), nlines = 6)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2 &lt;- err$new_error(conditionMessage(e), call. = conditionCall(e))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     class(e2) &lt;- c("callr_remote_error", class(e2))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2$error &lt;- e</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     calls &lt;- sys.calls()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     dcframe &lt;- which(vapply(calls, function(x) length(x) &gt;= 1 &amp;&amp; identical(x[[</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       1]], quote(do.call)), logical(1)))[1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is.na(dcframe)) e2$`_ignore` &lt;- list(c(1, dcframe + 1L))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2$`_pid` &lt;- Sys.getpid()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2$`_timestamp` &lt;- Sys.time()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (inherits(e, "rlib_error_2_0")) e2$parent &lt;- e$parent</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2 &lt;- err$add_trace_back(e2, embed = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     saveRDS(list("error", e2), file = paste0(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       "/home/nat/.tmp/RtmpqwGfV0/callr-res-15ea701f9a8237", ".error"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }, interrupt = function(e) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     callr_data &lt;- as.environment("tools:callr")$`__callr_data__`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     err &lt;- callr_data$err</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     assign(".Traceback", .traceback(4), envir = callr_data)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     dump.frames("__callr_dump__")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     assign(".Last.dump", .GlobalEnv$`__callr_dump__`, envir = callr_data)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     rm("__callr_dump__", envir = .GlobalEnv)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e$call &lt;- deparse(conditionCall(e), nlines = 6)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2 &lt;- err$new_error(conditionMessage(e), call. = conditionCall(e))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     class(e2) &lt;- c("callr_remote_error", class(e2))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2$error &lt;- e</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     calls &lt;- sys.calls()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     dcframe &lt;- which(vapply(calls, function(x) length(x) &gt;= 1 &amp;&amp; identical(x[[</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       1]], quote(do.call)), logical(1)))[1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is.na(dcframe)) e2$`_ignore` &lt;- list(c(1, dcframe + 1L))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2$`_pid` &lt;- Sys.getpid()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2$`_timestamp` &lt;- Sys.time()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (inherits(e, "rlib_error_2_0")) e2$parent &lt;- e$parent</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2 &lt;- err$add_trace_back(e2, embed = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     saveRDS(list("error", e2), file = paste0(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       "/home/nat/.tmp/RtmpqwGfV0/callr-res-15ea701f9a8237", ".error"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }, callr_message = function(e) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   try(signalCondition(e))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }), error = function(e) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   try(stop(e))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }, interrupt = function(e) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   e</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> })</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; tryCatchList(expr, classes, parentenv, handlers)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; tryCatchOne(tryCatchList(expr, names[-nh], parentenv, handlers[-nh]), names[nh],</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> parentenv, handlers[[nh]])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; doTryCatch(return(expr), name, parentenv, handler)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; tryCatchList(expr, names[-nh], parentenv, handlers[-nh])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; tryCatchOne(expr, names, parentenv, handlers[[1L]])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; doTryCatch(return(expr), name, parentenv, handler)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; withCallingHandlers({</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   saveRDS(do.call(do.call, c(readRDS(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     "/home/nat/.tmp/RtmpqwGfV0/callr-fun-15ea7056d2377"), list(envir = .GlobalEnv,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     quote = TRUE)), envir = .GlobalEnv, quote = TRUE), file = "/home/nat/.tmp/RtmpqwGfV0/callr-res-15ea701f9a8237")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   flush(stdout())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   flush(stderr())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   invisible()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }, error = function(e) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     callr_data &lt;- as.environment("tools:callr")$`__callr_data__`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     err &lt;- callr_data$err</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     assign(".Traceback", .traceback(4), envir = callr_data)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     dump.frames("__callr_dump__")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     assign(".Last.dump", .GlobalEnv$`__callr_dump__`, envir = callr_data)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     rm("__callr_dump__", envir = .GlobalEnv)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e$call &lt;- deparse(conditionCall(e), nlines = 6)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2 &lt;- err$new_error(conditionMessage(e), call. = conditionCall(e))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     class(e2) &lt;- c("callr_remote_error", class(e2))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2$error &lt;- e</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     calls &lt;- sys.calls()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     dcframe &lt;- which(vapply(calls, function(x) length(x) &gt;= 1 &amp;&amp; identical(x[[</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       1]], quote(do.call)), logical(1)))[1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is.na(dcframe)) e2$`_ignore` &lt;- list(c(1, dcframe + 1L))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2$`_pid` &lt;- Sys.getpid()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2$`_timestamp` &lt;- Sys.time()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (inherits(e, "rlib_error_2_0")) e2$parent &lt;- e$parent</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2 &lt;- err$add_trace_back(e2, embed = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     saveRDS(list("error", e2), file = paste0(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       "/home/nat/.tmp/RtmpqwGfV0/callr-res-15ea701f9a8237", ".error"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }, interrupt = function(e) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     callr_data &lt;- as.environment("tools:callr")$`__callr_data__`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     err &lt;- callr_data$err</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     assign(".Traceback", .traceback(4), envir = callr_data)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     dump.frames("__callr_dump__")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     assign(".Last.dump", .GlobalEnv$`__callr_dump__`, envir = callr_data)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     rm("__callr_dump__", envir = .GlobalEnv)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e$call &lt;- deparse(conditionCall(e), nlines = 6)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2 &lt;- err$new_error(conditionMessage(e), call. = conditionCall(e))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     class(e2) &lt;- c("callr_remote_error", class(e2))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2$error &lt;- e</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     calls &lt;- sys.calls()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     dcframe &lt;- which(vapply(calls, function(x) length(x) &gt;= 1 &amp;&amp; identical(x[[</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       1]], quote(do.call)), logical(1)))[1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (!is.na(dcframe)) e2$`_ignore` &lt;- list(c(1, dcframe + 1L))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2$`_pid` &lt;- Sys.getpid()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2$`_timestamp` &lt;- Sys.time()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (inherits(e, "rlib_error_2_0")) e2$parent &lt;- e$parent</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     e2 &lt;- err$add_trace_back(e2, embed = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     saveRDS(list("error", e2), file = paste0(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       "/home/nat/.tmp/RtmpqwGfV0/callr-res-15ea701f9a8237", ".error"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }, callr_message = function(e) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   try(signalCondition(e))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> })</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; saveRDS(do.call(do.call, c(readRDS(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   "/home/nat/.tmp/RtmpqwGfV0/callr-fun-15ea7056d2377"), list(envir = .GlobalEnv,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   quote = TRUE)), envir = .GlobalEnv, quote = TRUE), file = "/home/nat/.tmp/RtmpqwGfV0/callr-res-15ea701f9a8237")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; do.call(do.call, c(readRDS("/home/nat/.tmp/RtmpqwGfV0/callr-fun-15ea7056d2377"),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> list(envir = .GlobalEnv, quote = TRUE)), envir = .GlobalEnv, quote = TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; &lt;function(what, args, quote = FALSE, envir = parent.frame()) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   if (!is.list(args)) stop("second argument must be a list")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   if (quote) args &lt;- lapply(args, enquote)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .Internal(do.call(what, args, envir))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }&gt;(base::quote(&lt;function(..., crayon_enabled, crayon_colors, pkgdown_internet) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   options(crayon.enabled = crayon_enabled, crayon.colors = crayon_colors,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     pkgdown.internet = pkgdown_internet)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   pkgdown::build_site(...)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }&gt;), base::quote(&lt;list: pkg = &lt;pkgdown&gt;, examples = TRUE, run_dont_run = FALSE,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   seed = 1014, lazy = FALSE, ...&gt;), envir = base::quote(&lt;environment&gt;), quote = base::quote(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   TRUE))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; &lt;function(..., crayon_enabled, crayon_colors, pkgdown_internet) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   options(crayon.enabled = crayon_enabled, crayon.colors = crayon_colors,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     pkgdown.internet = pkgdown_internet)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   pkgdown::build_site(...)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }&gt;(pkg = base::quote(&lt;pkgdown&gt;), examples = base::quote(TRUE), run_dont_run = base::quote(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   FALSE), seed = base::quote(1014), lazy = base::quote(FALSE), override = base::quote(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   &lt;list: &gt;), install = base::quote(FALSE), preview = base::quote(FALSE),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> new_process = base::quote(FALSE), devel = base::quote(FALSE), crayon_enabled = base::quote(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   TRUE), crayon_colors = base::quote(256L), pkgdown_internet = base::quote(TRUE))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; pkgdown::build_site(...)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; build_site_local(pkg = pkg, examples = examples, run_dont_run = run_dont_run,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   seed = seed, lazy = lazy, override = override, preview = preview, devel = devel)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; build_reference(pkg, lazy = lazy, examples = examples, run_dont_run = run_dont_run,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   seed = seed, override = override, preview = FALSE, devel = devel)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; purrr::map(topics, build_reference_topic, pkg = pkg, lazy = lazy, examples_env = examples_env,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   run_dont_run = run_dont_run)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; .f(.x[[i]], ...)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; withCallingHandlers(data_reference_topic(topic, pkg, examples_env = examples_env,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   run_dont_run = run_dont_run), error = function(err) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   msg &lt;- c(paste0("Failed to parse Rd in ", topic$file_in), i = err$message)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   abort(msg, parent = err)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> })</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; data_reference_topic(topic, pkg, examples_env = examples_env, run_dont_run = run_dont_run)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; run_examples(tags$tag_examples[[1]], env = if (is.null(examples_env)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ) NULL else new.env(parent = examples_env), topic = tools::file_path_sans_ext(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   topic$file_in), run_dont_run = run_dont_run)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; highlight_examples(code, topic, env = env)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; downlit::evaluate_and_highlight(code, fig_save = fig_save_topic, env = child_env(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   env), output_handler = evaluate::new_output_handler(value = pkgdown_print))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; evaluate::evaluate(code, child_env(env), new_device = TRUE, output_handler = output_handler)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; evaluate_call(expr, parsed$src[[i]], envir = envir, enclos = enclos, debug = debug,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> last = i == length(out), use_try = stop_on_error != 2L, keep_warning = keep_warning,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> keep_message = keep_message, output_handler = output_handler, include_timing = include_timing)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; timing_fn(handle(ev &lt;- withCallingHandlers(withVisible(eval(expr, envir, enclos)),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> warning = wHandler, error = eHandler, message = mHandler)))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; handle(ev &lt;- withCallingHandlers(withVisible(eval(expr, envir, enclos)),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> warning = wHandler, error = eHandler, message = mHandler))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; try(f, silent = TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; tryCatch(expr, error = function(e) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   call &lt;- conditionCall(e)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   if (!is.null(call)) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (identical(call[[1L]], quote(doTryCatch))) call &lt;- sys.call(-4L)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     dcall &lt;- deparse(call, nlines = 1L)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     prefix &lt;- paste("Error in", dcall, ": ")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     LONG &lt;- 75L</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     sm &lt;- strsplit(conditionMessage(e), "\n")[[1L]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     w &lt;- 14L + nchar(dcall, type = "w") + nchar(sm[1L], type = "w")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (is.na(w)) w &lt;- 14L + nchar(dcall, type = "b") + nchar(sm[1L], type = "b")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (w &gt; LONG) prefix &lt;- paste0(prefix, "\n  ")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   } else prefix &lt;- "Error : "</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   msg &lt;- paste0(prefix, conditionMessage(e), "\n")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .Internal(seterrmessage(msg[1L]))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   if (!silent &amp;&amp; isTRUE(getOption("show.error.messages"))) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     cat(msg, file = outFile)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     .Internal(printDeferredWarnings())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   invisible(structure(msg, class = "try-error", condition = e))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> })</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; tryCatchList(expr, classes, parentenv, handlers)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; tryCatchOne(expr, names, parentenv, handlers[[1L]])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; doTryCatch(return(expr), name, parentenv, handler)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; withCallingHandlers(withVisible(eval(expr, envir, enclos)), warning = wHandler,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> error = eHandler, message = mHandler)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; withVisible(eval(expr, envir, enclos))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; eval(expr, envir, enclos)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; eval(expr, envir, enclos)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	 -&gt; withinHumdrum(humdata, ~ table(.), by ~ Spine)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> In the call withinHumdrum(humdrumR = _), the argument humdrumR must be a humdrumR object.</span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="http://fathermckenzie.net/" class="external-link">Nathaniel Condit-Schultz</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer></div>

  

  

  </body></html>

